import { Meta, Markdown, ArgTypes, Canvas, Story } from "storybook/blocks";
import * as Stories from "./InlineEditLabel.stories";
import ReadmeSource from "./README.md?raw";

export const scaffoldRefMatch = ReadmeSource.match(/scaffold_ref:\s*([^\s]+)/i);
export const ownerMatch = ReadmeSource.match(/^_Owner:\s*(@[^\s]+)/im);

export const scaffoldRef =
  scaffoldRefMatch?.[1]?.trim() ?? "Missing scaffold_ref";
export const ownerHandle = ownerMatch?.[1]?.trim() ?? "Unassigned";

<Meta of={Stories} />

<div style={{ display: "flex", gap: "1rem", marginBottom: "1rem", flexWrap: "wrap" }}>
  <div>
    <div style={{ fontSize: "0.75rem", letterSpacing: "0.08em", textTransform: "uppercase", color: "var(--text-muted-color)" }}>
      Template
    </div>
    <code
      data-testid="docs-template-ref"
      style={
        scaffoldRef === "Missing scaffold_ref"
          ? { color: "var(--color-danger-text)" }
          : undefined
      }
    >
      {scaffoldRef}
    </code>
  </div>
  <div>
    <div style={{ fontSize: "0.75rem", letterSpacing: "0.08em", textTransform: "uppercase", color: "var(--text-muted-color)" }}>
      Owner
    </div>
    <code
      data-testid="docs-owner-handle"
      style={
        ownerHandle === "Unassigned"
          ? { color: "var(--color-danger-text)" }
          : undefined
      }
    >
      {ownerHandle}
    </code>
  </div>
</div>

<Markdown>{ReadmeSource}</Markdown>

## Interactive
<Canvas>
  <Story of={Stories.Basic} />
</Canvas>

## Empty state
<Canvas>
  <Story of={Stories.EmptyState} />
</Canvas>

## Interaction test
<Canvas>
  <Story of={Stories.Interaction} />
</Canvas>

## Error path
<Canvas>
  <Story of={Stories.RetryOnError} />
</Canvas>

## Props
<ArgTypes of={Stories} />
