import{_ as a,c as o,o as i,af as t}from"./chunks/framework.BkXTFsxB.js";const g=JSON.parse('{"title":"PR-Based Changelog Pipeline","description":"","frontmatter":{},"headers":[],"relativePath":"workflows/pr-changelog-pipeline.md","filePath":"workflows/pr-changelog-pipeline.md","lastUpdated":1762001301000}'),r={name:"workflows/pr-changelog-pipeline.md"};function n(l,e,s,c,d,h){return i(),o("div",null,[...e[0]||(e[0]=[t('<h1 id="pr-based-changelog-pipeline" tabindex="-1">PR-Based Changelog Pipeline <a class="header-anchor" href="#pr-based-changelog-pipeline" aria-label="Permalink to &quot;PR-Based Changelog Pipeline&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>The Plaincraft project uses a <strong>PR-based changelog mechanism</strong> instead of commit message parsing. This approach extracts changelog entries directly from merged PR bodies, providing more accurate and structured changelog management.</p><h2 id="how-it-works" tabindex="-1">How It Works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to &quot;How It Works&quot;">​</a></h2><h3 id="_1-pr-creation-with-changelog-section" tabindex="-1">1. PR Creation with Changelog Section <a class="header-anchor" href="#_1-pr-creation-with-changelog-section" aria-label="Permalink to &quot;1. PR Creation with Changelog Section&quot;">​</a></h3><p>When creating a PR, include a <code>## Changes</code> section in the PR body:</p><p>```markdown</p><h2 id="changes" tabindex="-1">Changes <a class="header-anchor" href="#changes" aria-label="Permalink to &quot;Changes&quot;">​</a></h2><ul><li>Added new feature X</li><li>Fixed bug in component Y</li><li>Updated documentation for Z ```</li></ul><h3 id="_2-automatic-extraction-on-merge" tabindex="-1">2. Automatic Extraction on Merge <a class="header-anchor" href="#_2-automatic-extraction-on-merge" aria-label="Permalink to &quot;2. Automatic Extraction on Merge&quot;">​</a></h3><p>When a PR is merged to <code>main</code>:</p><ol><li>The <code>pr-changelog</code> workflow automatically triggers</li><li><code>scripts/ops/extract-pr-changelog.mjs</code> extracts the changelog section</li><li>A markdown summary file is created in <code>_tmp/pr-{number}-{slug}.md</code></li><li>The summary file is committed back to <code>main</code> with <code>[skip ci]</code></li></ol><h3 id="_3-consolidation-on-version-bump" tabindex="-1">3. Consolidation on Version Bump <a class="header-anchor" href="#_3-consolidation-on-version-bump" aria-label="Permalink to &quot;3. Consolidation on Version Bump&quot;">​</a></h3><p>When bumping the version (via <code>version</code> workflow or manual <code>pnpm changelog</code>):</p><ol><li>All <code>_tmp/*.md</code> files are consolidated into <code>CHANGELOG.md</code></li><li>Entries are organized under the new version number</li><li>Temporary summary files are deleted (unless <code>--keep-temp</code> is used)</li></ol><h2 id="workflow-files" tabindex="-1">Workflow Files <a class="header-anchor" href="#workflow-files" aria-label="Permalink to &quot;Workflow Files&quot;">​</a></h2><ul><li><code>.github/workflows/pr-changelog.yml</code> - Extracts changelog on PR merge</li><li><code>.github/workflows/version.yml</code> - Consolidates changelog on version bump</li></ul><h2 id="scripts" tabindex="-1">Scripts <a class="header-anchor" href="#scripts" aria-label="Permalink to &quot;Scripts&quot;">​</a></h2><h3 id="extract-changelog-from-pr" tabindex="-1">Extract Changelog from PR <a class="header-anchor" href="#extract-changelog-from-pr" aria-label="Permalink to &quot;Extract Changelog from PR&quot;">​</a></h3><p>```bash</p><h1 id="extract-from-specific-pr" tabindex="-1">Extract from specific PR <a class="header-anchor" href="#extract-from-specific-pr" aria-label="Permalink to &quot;Extract from specific PR&quot;">​</a></h1><p>pnpm changelog:extract -- --pr-number 123 --yes</p><h1 id="dry-run-preview" tabindex="-1">Dry-run preview <a class="header-anchor" href="#dry-run-preview" aria-label="Permalink to &quot;Dry-run preview&quot;">​</a></h1><p>pnpm changelog:extract -- --pr-number 123 ```</p><h3 id="consolidate-changelog" tabindex="-1">Consolidate Changelog <a class="header-anchor" href="#consolidate-changelog" aria-label="Permalink to &quot;Consolidate Changelog&quot;">​</a></h3><p>```bash</p><h1 id="consolidate-all-summaries-into-changelog-md" tabindex="-1">Consolidate all summaries into CHANGELOG.md <a class="header-anchor" href="#consolidate-all-summaries-into-changelog-md" aria-label="Permalink to &quot;Consolidate all summaries into CHANGELOG.md&quot;">​</a></h1><p>pnpm changelog --yes</p><h1 id="dry-run-preview-1" tabindex="-1">Dry-run preview <a class="header-anchor" href="#dry-run-preview-1" aria-label="Permalink to &quot;Dry-run preview&quot;">​</a></h1><p>pnpm changelog</p><h1 id="keep-temporary-files-after-consolidation" tabindex="-1">Keep temporary files after consolidation <a class="header-anchor" href="#keep-temporary-files-after-consolidation" aria-label="Permalink to &quot;Keep temporary files after consolidation&quot;">​</a></h1><p>pnpm changelog --yes --keep-temp ```</p><h2 id="changelog-section-patterns" tabindex="-1">Changelog Section Patterns <a class="header-anchor" href="#changelog-section-patterns" aria-label="Permalink to &quot;Changelog Section Patterns&quot;">​</a></h2><p>The extraction script recognizes the following section headers:</p><ul><li><code>## Changes</code></li><li><code>## Changelog</code></li><li><code>## What Changed</code></li><li><code>## Summary</code></li><li><code>### Changes</code></li></ul><h2 id="benefits-over-commit-based-approach" tabindex="-1">Benefits Over Commit-Based Approach <a class="header-anchor" href="#benefits-over-commit-based-approach" aria-label="Permalink to &quot;Benefits Over Commit-Based Approach&quot;">​</a></h2><ol><li><strong>More Accurate</strong>: Changelog content is explicitly written, not parsed from commits</li><li><strong>Less Strict</strong>: No rigid commit message format requirements</li><li><strong>Better Context</strong>: PR bodies provide more space for detailed change descriptions</li><li><strong>Easier to Review</strong>: Changelog content is reviewed as part of PR review</li><li><strong>Flexible</strong>: Authors can structure changelog content as needed</li></ol><h2 id="migration-notes" tabindex="-1">Migration Notes <a class="header-anchor" href="#migration-notes" aria-label="Permalink to &quot;Migration Notes&quot;">​</a></h2><h3 id="old-approach-deprecated" tabindex="-1">Old Approach (Deprecated) <a class="header-anchor" href="#old-approach-deprecated" aria-label="Permalink to &quot;Old Approach (Deprecated)&quot;">​</a></h3><ul><li>Relied on parsing <code>[TAG]</code> from commit messages</li><li>Required strict commit message formats</li><li>Often missed or incorrectly parsed changes</li></ul><h3 id="new-approach-current" tabindex="-1">New Approach (Current) <a class="header-anchor" href="#new-approach-current" aria-label="Permalink to &quot;New Approach (Current)&quot;">​</a></h3><ul><li>Extracts from PR body <code>## Changes</code> section</li><li>No commit message requirements</li><li>Explicit, reviewer-approved changelog content</li></ul><h2 id="example-pr-body" tabindex="-1">Example PR Body <a class="header-anchor" href="#example-pr-body" aria-label="Permalink to &quot;Example PR Body&quot;">​</a></h2><p>```markdown</p><h2 id="overview-1" tabindex="-1">Overview <a class="header-anchor" href="#overview-1" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>This PR implements the new dashboard analytics feature.</p><h2 id="changes-1" tabindex="-1">Changes <a class="header-anchor" href="#changes-1" aria-label="Permalink to &quot;Changes&quot;">​</a></h2><ul><li>Added <code>DashboardAnalytics</code> component with chart support</li><li>Integrated with analytics API endpoint</li><li>Added unit tests for data processing logic</li><li>Updated storybook with analytics examples</li></ul><h2 id="testing" tabindex="-1">Testing <a class="header-anchor" href="#testing" aria-label="Permalink to &quot;Testing&quot;">​</a></h2><ul><li>Manual testing with sample data</li><li>All unit tests passing</li><li>Verified mobile responsiveness</li></ul><h2 id="related" tabindex="-1">Related <a class="header-anchor" href="#related" aria-label="Permalink to &quot;Related&quot;">​</a></h2><p>Closes #123 ```</p><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="no-changelog-section-found" tabindex="-1">&quot;No changelog section found&quot; <a class="header-anchor" href="#no-changelog-section-found" aria-label="Permalink to &quot;&quot;No changelog section found&quot;&quot;">​</a></h3><p><strong>Problem</strong>: The PR was merged but no summary file was created.</p><p><strong>Solution</strong>: Ensure the PR body includes a recognized changelog section header (<code>## Changes</code>, etc.) with content below it.</p><h3 id="summary-files-not-consolidating" tabindex="-1">Summary files not consolidating <a class="header-anchor" href="#summary-files-not-consolidating" aria-label="Permalink to &quot;Summary files not consolidating&quot;">​</a></h3><p><strong>Problem</strong>: Summary files exist in <code>_tmp/</code> but aren&#39;t being consolidated.</p><p><strong>Solution</strong>: Run <code>pnpm changelog --yes</code> to manually consolidate, or wait for the next version bump workflow.</p><h3 id="duplicate-entries" tabindex="-1">Duplicate entries <a class="header-anchor" href="#duplicate-entries" aria-label="Permalink to &quot;Duplicate entries&quot;">​</a></h3><p><strong>Problem</strong>: Same changelog entry appears multiple times.</p><p><strong>Solution</strong>: The consolidation script automatically deduplicates entries by version. If you see duplicates, they&#39;re likely from different versions.</p>',62)])])}const m=a(r,[["render",n]]);export{g as __pageData,m as default};
